@using MovieFiles.Api.Client.Services;
@using System.Globalization;
@inject IRatingService RatingService
@inject AuthenticationStateProvider AuthenticationStateProvider

@if (IsLoading)
{
}
else if (AverageRating.HasValue)
{
        <div class="rating">
            <img class="star" src="svgs/star.svg">
        <h4 class="item">@AverageRating.Value.ToString("0.0", CultureInfo.InvariantCulture)</h4>
        </div>
}
else
{
        <div class="rating">
            <p class="noRating">No ratings available.</p>
        </div>
}

@code {
    [Parameter]
    public int MovieId { get; set; }
    public double? AverageRating { get; set; }
    public bool IsLoading { get; set; } = true;

    protected override async Task OnParametersSetAsync()
    {
        AverageRating = null;
        AverageRating = await RatingService.GetAverageRating(MovieId);
        IsLoading = false;
    }
}
